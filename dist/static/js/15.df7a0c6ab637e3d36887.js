webpackJsonp([15],{WFSN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("woOf"),n=i.n(a),r=i("Xxa5"),s=i.n(r),o=i("exGp"),c=i.n(o),l=i("mvHQ"),u=i.n(l),d=i("zMP6"),h=i("pgfl"),p=i("cMGX"),b=i("JnX+"),f=i("5xqa"),g={name:"combined",components:{AutoSearch:h.a,Drugs:f.a,Pagination:p.a},data:function(){return{loading:!1,tabIndex:0,auditlevel:b.a,choose:{id:"",label:""},currentRow:null,currentKey:null,oldList:[],compatibility:[],interaction:[],repetition:[],oldCompatibility:[],oldInteraction:[],oldRepetition:[],searchList:[],reactionList:[],searchKey:"",compatibilityList:[],labelList:[],page:{pageSize:10,pageNo:1,totalCount:0,totalPage:0}}},created:function(){this.getAllCompatibility(),this.getLabelList()},beforeRouteLeave:function(t,e,i){var a=!0;0===this.tabIndex&&this.compatibility.length>0?a=this.oldCompatibility===u()(this.compatibility):1===this.tabIndex&&this.interaction.length>0?a=this.oldInteraction===u()(this.interaction):2===this.tabIndex&&this.repetition.length>0&&(a=this.oldRepetition===u()(this.repetition)),a?i():this.$confirm("当前页面未保存，是否确认离开？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i()}).catch(function(){i(!1)})},methods:{beforeLeave:function(t){var e=this,i=!0;if(0===this.tabIndex&&this.compatibility.length>0?i=this.oldCompatibility===u()(this.compatibility):1===this.tabIndex&&this.interaction.length>0?i=this.oldInteraction===u()(this.interaction):2===this.tabIndex&&this.repetition.length>0&&(i=this.oldRepetition===u()(this.repetition)),!i)return this.$confirm("当前页面未保存，是否确认离开？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.tabIndex=Number(t),e.compatibility=JSON.parse(e.oldCompatibility),e.interaction=JSON.parse(e.oldInteraction),e.repetition=JSON.parse(e.oldRepetition),e.getReactionList(e.tabIndex+1)}).catch(function(){throw console.log("cancle"),new Error("cancle")});this.tabIndex=Number(t),this.getReactionList(this.tabIndex+1)},handleAdd:function(t){var e=this;return c()(s.a.mark(function i(){var a,n;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={id:e.choose.id,pairId:t.id,type:e.tabIndex+1,sign:e.choose.sign,sign1:t.sign},i.next=3,Object(d.b)(a);case 3:0===(n=i.sent).code?(e.$message.success(n.msg),e.getList()):e.$message.error(n.msg);case 5:case"end":return i.stop()}},i,e)}))()},handleSearch:function(){this.getLabelList(this.searchKey)},updateChoose:function(t){var e=this,i=!0;if(0===this.tabIndex&&this.compatibility.length>0?i=this.oldCompatibility===u()(this.compatibility):1===this.tabIndex&&this.interaction.length>0?i=this.oldInteraction===u()(this.interaction):2===this.tabIndex&&this.repetition.length>0&&(i=this.oldRepetition===u()(this.repetition)),!i)return this.$confirm("当前页面未保存，是否确认离开？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.choose=t,e.getList(),e.currentKey=t}).catch(function(){e.$refs.drugTree.$refs.tree.setCurrentKey(e.currentKey)});this.choose=t,this.getList(),this.currentKey=t},handleClickRow:function(t){var e=this;n()(t,{sign:2});var i=!0;if(0===this.tabIndex&&this.compatibility.length>0?i=this.oldCompatibility===u()(this.compatibility):1===this.tabIndex&&this.interaction.length>0?i=this.oldInteraction===u()(this.interaction):2===this.tabIndex&&this.repetition.length>0&&(i=this.oldRepetition===u()(this.repetition)),!i)return this.$confirm("当前页面未保存，是否确认离开？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.choose=t,e.getList(),e.currentRow=t}).catch(function(){e.$refs.tableTags.setCurrentRow(e.currentRow)});this.choose=t,this.getList(),this.currentRow=t},handleSave:function(){var t=this;return c()(s.a.mark(function e(){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loading=!0,i=void 0,0!==t.tabIndex){e.next=8;break}return e.next=5,Object(d.x)(u()(t.compatibility));case 5:i=e.sent,e.next=18;break;case 8:if(1!==t.tabIndex){e.next=14;break}return e.next=11,Object(d.x)(u()(t.interaction));case 11:i=e.sent,e.next=18;break;case 14:if(2!==t.tabIndex){e.next=18;break}return e.next=17,Object(d.x)(u()(t.repetition));case 17:i=e.sent;case 18:t.loading=!1,0===i.code?(t.$message.success("保存成功！"),t.getList()):t.$message.error(i.msg);case 20:case"end":return e.stop()}},e,t)}))()},clickDelete:function(t){var e=this;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.handleDelete(t)}).catch(function(){})},handleDelete:function(t){var e=this;return c()(s.a.mark(function i(){var a,n;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={id:t.id?t.id:"",type:t.type?t.type:"",reactionDescription:t.reactionDescription?t.reactionDescription:"",auditLevelId:t.auditLevelId?t.auditLevelId:"",medcineId:t.medcineId?t.medcineId:"",medcinePairId:t.medcinePairId?t.medcinePairId:"",labelId:t.labelId?t.labelId:"",labelPairId:t.labelPairId?t.labelPairId:"",categoryId:t.categoryId?t.categoryId:"",categoryPairId:t.categoryPairId?t.categoryPairId:""},i.next=3,Object(d.k)(u()(a));case 3:0===(n=i.sent).code?(e.$message.success(n.msg),e.getList()):e.$message.error(n.msg);case 5:case"end":return i.stop()}},i,e)}))()},getReactionList:function(t){var e=this;return c()(s.a.mark(function i(){var a;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(d.w)({type:t});case 2:0===(a=i.sent).code?(e.reactionList=a.result,e.reactionList.forEach(function(t){n()(t,{value:t.reactionDescription})})):e.$message.error(a.msg);case 4:case"end":return i.stop()}},i,e)}))()},getList:function(){var t=this;return c()(s.a.mark(function e(){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.r)({id:t.choose.id,sign:Number(t.choose.sign)});case 2:0===(i=e.sent).code?(t.compatibility=i.result.compatibility,t.interaction=i.result.interaction,t.repetition=i.result.repetition,t.oldCompatibility=u()(i.result.compatibility),t.oldInteraction=u()(i.result.interaction),t.oldRepetition=u()(i.result.repetition)):(t.$message.error(i.msg),t.compatibility=[],t.interaction=[],t.repetition=[]);case 4:case"end":return e.stop()}},e,t)}))()},getLabelList:function(t){var e=this;return c()(s.a.mark(function i(){var a,n;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={name:t,pageNo:e.page.pageNo,pageSize:e.page.pageSize},i.next=3,Object(d.u)(a);case 3:0===(n=i.sent).code?(e.labelList=n.result,e.page=n.page||e.page):e.$message.error(n.msg);case 5:case"end":return i.stop()}},i,e)}))()},getAllCompatibility:function(){var t=this;return c()(s.a.mark(function e(){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.o)();case 2:0===(i=e.sent).code&&(t.searchList=i.result,t.searchList.forEach(function(t){n()(t,{value:t.name})}));case 4:case"end":return e.stop()}},e,t)}))()},tableHeaderName:function(t){t.row,t.rowIndex;return"table-header"},querySearch:function(t,e){var i=this.reactionList;e(t?i.filter(this.createFilter(t)):i)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}}}},m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100%"}},[i("el-row",{staticStyle:{height:"100%"},attrs:{gutter:20}},[i("el-col",{staticStyle:{height:"100%"},attrs:{span:9}},[i("el-card",{staticClass:"box-card",staticStyle:{height:"100%","overflow-y":"auto"}},[i("div",{staticClass:"clearfix",staticStyle:{height:"100%"},attrs:{slot:"header"},slot:"header"},[i("span",{staticClass:"f4"},[t._v("药品与标签列表")])]),t._v(" "),i("div",[i("el-tabs",{attrs:{"before-leave":t.beforeLeave}},[i("el-tab-pane",{attrs:{label:"药品列表"}},[i("Drugs",{ref:"drugTree",attrs:{type:"all"},on:{updateChoose:t.updateChoose}})],1),t._v(" "),i("el-tab-pane",{attrs:{label:"标签列表"}},[i("el-input",{attrs:{size:"small",placeholder:"查找标签",clearable:""},on:{change:t.handleSearch},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),t._v(" "),i("div",{staticClass:"space"}),t._v(" "),i("el-table",{ref:"tableTags",staticStyle:{width:"100%"},attrs:{data:t.labelList,"highlight-current-row":"",border:"",size:"small","header-cell-class-name":t.tableHeaderName},on:{"row-click":t.handleClickRow}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}})],1),t._v(" "),i("Pagination",{staticClass:"text-center",attrs:{page:t.page},on:{handlePageChange:t.getLabelList}})],1)],1)],1)])],1),t._v(" "),i("el-col",{staticStyle:{height:"100%"},attrs:{span:15}},[i("el-card",{staticClass:"box-card",staticStyle:{height:"100%"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("添加规则")]),t._v(" "),t.choose.name?[i("span",{staticClass:"f1 font-bold"},[t._v("【 "+t._s(t.choose.name)+" 】")]),t._v(" "),i("el-button",{staticStyle:{position:"absolute",top:"15px",right:"20px"},attrs:{type:"primary",size:"small",loading:t.loading},on:{click:t.handleSave}},[t._v("保存")])]:t._e()],2),t._v(" "),t.choose.name?t._e():i("div",{staticClass:"f4"},[t._v("请先选择药品")]),t._v(" "),t.choose.name?i("div",[i("AutoSearch",{attrs:{placeHolder:"添加药品、种类或标签",list:t.searchList},on:{handleSelect:t.handleAdd}}),t._v(" "),i("div",{staticClass:"space"}),t._v(" "),i("el-tabs",{attrs:{"before-leave":t.beforeLeave}},[i("el-tab-pane",{attrs:{label:"配伍禁忌"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.compatibility,border:"",size:"small"}},[i("el-table-column",{attrs:{prop:"name",label:"药物B名称"}}),t._v(" "),i("el-table-column",{attrs:{prop:"reactionDescription",label:"作用机制与结果"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-autocomplete",{attrs:{size:"small",placeholder:"作用机制与结果",clearable:"","fetch-suggestions":t.querySearch},model:{value:e.row.reactionDescription,callback:function(i){t.$set(e.row,"reactionDescription",i)},expression:"scope.row.reactionDescription"}},[i("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"action",label:"审方等级",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-select",{attrs:{size:"small",placeholder:"审方等级"},model:{value:e.row.auditLevelId,callback:function(i){t.$set(e.row,"auditLevelId",i)},expression:"scope.row.auditLevelId"}},t._l(t.auditlevel,function(t){return i("el-option",{key:t.id,attrs:{label:t.desp,value:t.id}})}),1)]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"enable",label:"操作",align:"center",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("i",{staticClass:"el-icon-delete text-red pointer",on:{click:function(i){return t.clickDelete(e.row)}}})]}}])})],1)],1),t._v(" "),i("el-tab-pane",{attrs:{label:"相互作用"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.interaction,border:"",size:"small"}},[i("el-table-column",{attrs:{prop:"name",label:"药物B名称"}}),t._v(" "),i("el-table-column",{attrs:{prop:"reactionDescription",label:"作用机制与结果"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-autocomplete",{attrs:{size:"small",placeholder:"作用机制与结果",clearable:"","fetch-suggestions":t.querySearch},model:{value:e.row.reactionDescription,callback:function(i){t.$set(e.row,"reactionDescription",i)},expression:"scope.row.reactionDescription"}},[i("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"enable",label:"操作",align:"center",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("i",{staticClass:"el-icon-delete text-red pointer",on:{click:function(i){return t.clickDelete(e.row)}}})]}}])})],1)],1),t._v(" "),i("el-tab-pane",{attrs:{label:"重复用药"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.repetition,border:"",size:"small"}},[i("el-table-column",{attrs:{prop:"name",label:"药物B名称"}}),t._v(" "),i("el-table-column",{attrs:{prop:"enable",label:"操作",align:"center",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("i",{staticClass:"el-icon-delete text-red pointer",on:{click:function(i){return t.clickDelete(e.row)}}})]}}])})],1)],1)],1)],1):t._e()])],1)],1)],1)};m._withStripped=!0;var v={render:m,staticRenderFns:[]},x=v;var y=i("VU/8")(g,x,!1,null,null,null);y.options.__file="src/view/rule/combined.vue";e.default=y.exports}});
//# sourceMappingURL=15.df7a0c6ab637e3d36887.js.map