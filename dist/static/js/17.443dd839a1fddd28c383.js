webpackJsonp([17],{"+jCw":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("woOf"),n=a.n(r),i=a("Gu7T"),s=a.n(i),l=a("mvHQ"),o=a.n(l),c=a("Xxa5"),u=a.n(c),d=a("exGp"),p=a.n(d),f=a("zMP6"),h=a("yCvJ"),m=a("JnX+"),g=a("cMGX"),v={props:["type"],components:{AutoSearch:a("pgfl").a},data:function(){return{typeId:"",loading:!1,medcineList:[],alltype:[],allclassify2:[],allclassify1:[],allhospital:[],form:{standardSource:"",type:"",category:"",subcategory:""}}},created:function(){var e=this;return p()(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.getAllMedcine(),t.next=3,e.getAllType();case 3:return t.next=5,e.getAllClassify2();case 5:return t.next=7,e.getAllClassify1();case 7:return t.next=9,e.getAllHospital();case 9:case"end":return t.stop()}},t,e)}))()},methods:{getCategory:function(e){this.typeId=e,this.getAllClassify1(e),this.getAllClassify2({typeId:e})},getSubCategory:function(e){this.getAllClassify2({typeId:this.typeId,classify1Id:e})},handleUpdate:function(){console.log("同步数据"),this.$message.error("等待接口")},handleSearch:function(e){var t=this;return p()(u.a.mark(function a(){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.name&&e.id?t.form.name=e.name:t.form.name="",t.$parent.page={pageSize:10,pageNo:1,totalCount:"",totalPage:""},a.next=4,t.$parent.getList(t.form);case 4:case"end":return a.stop()}},a,t)}))()},handleSave:function(){var e=this;return p()(u.a.mark(function t(){var a,r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loading=!0,"org"!==e.type){t.next=8;break}return a=o()(e.$parent.arr),t.next=5,Object(f.y)(a);case 5:r=t.sent,e.loading=!1,0===r.code?(e.$message.success("保存成功！"),e.$parent.getList()):e.$message.error(r.msg);case 8:case"end":return t.stop()}},t,e)}))()},getAllType:function(){var e=this;return p()(u.a.mark(function t(){var a;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.i)();case 2:0===(a=t.sent).code&&(e.alltype=[{id:"",typeName:"全部"}].concat(s()(a.result)));case 4:case"end":return t.stop()}},t,e)}))()},getAllClassify2:function(e){var t=this;return p()(u.a.mark(function a(){var r,n;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r={},e&&(r={type:e.typeId,classify1:e.classify1Id}),a.next=4,Object(h.g)(r);case 4:0===(n=a.sent).code&&(t.allclassify2=[{id:"",subcategoryName:"全部"}].concat(s()(n.result)));case 6:case"end":return a.stop()}},a,t)}))()},getAllClassify1:function(e){var t=this;return p()(u.a.mark(function a(){var r;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(h.f)({type:e});case 2:0===(r=a.sent).code&&(t.allclassify1=[{id:"",categoryName:"全部"}].concat(s()(r.result)));case 4:case"end":return a.stop()}},a,t)}))()},getAllHospital:function(){var e=this;return p()(u.a.mark(function t(){var a;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.h)();case 2:0===(a=t.sent).code&&(e.allhospital=[{id:"",unitName:"全部"}].concat(s()(a.result)));case 4:case"end":return t.stop()}},t,e)}))()},getAllMedcine:function(){var e=this;return p()(u.a.mark(function t(){var a;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.h)();case 2:0===(a=t.sent).code&&(e.medcineList=a.result,e.medcineList.forEach(function(e){n()(e,{value:e.name})}));case 4:case"end":return t.stop()}},t,e)}))()}}},y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{inline:!0,model:e.form,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"单位名称："}},[a("el-select",{attrs:{placeholder:"单位名称"},model:{value:e.form.standardSource,callback:function(t){e.$set(e.form,"standardSource",t)},expression:"form.standardSource"}},e._l(e.allhospital,function(e){return a("el-option",{key:e.id,attrs:{label:e.unitName,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"中西药："}},[a("el-select",{attrs:{placeholder:"中西药"},on:{change:e.getCategory},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.alltype,function(e){return a("el-option",{key:e.id,attrs:{label:e.typeName,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"大分类："}},[a("el-select",{attrs:{placeholder:"大分类"},on:{change:e.getSubCategory},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.allclassify1,function(e){return a("el-option",{key:e.id,attrs:{label:e.categoryName,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"小分类："}},[a("el-select",{attrs:{placeholder:"小分类"},model:{value:e.form.subcategory,callback:function(t){e.$set(e.form,"subcategory",t)},expression:"form.subcategory"}},e._l(e.allclassify2,function(e){return a("el-option",{key:e.id,attrs:{label:e.subcategoryName,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("AutoSearch",{attrs:{placeHolder:"输入药品名称",list:e.medcineList},on:{handleSelect:e.handleSearch}})],1),e._v(" "),a("el-col",{staticClass:"text-right",attrs:{span:8}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleUpdate}},[e._v("同步数据")]),e._v(" "),"org"==e.type?a("el-button",{attrs:{size:"small",type:"primary",loading:e.loading},on:{click:e.handleSave}},[e._v("保存")]):e._e()],1)],1)],1)};y._withStripped=!0;var b={render:y,staticRenderFns:[]},w=b;var x=a("VU/8")(v,w,!1,null,null,null);x.options.__file="src/view/drug/components/SearchInfo.vue";var k=x.exports,_={props:["type"],name:"",data:function(){return{filterText:"",allcategory:[],allmedcine:[],defaultProps:{children:"children",label:"name"},list:[{id:"01",name:"按药理作用分类",children:[]}]}},created:function(){var e=this;return p()(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getAllCategory();case 2:if("paas"==e.type||"org"==e.type){t.next=5;break}return t.next=5,e.getAllMedcine();case 5:return t.next=7,e.formatList(e.list,"01");case 7:case"end":return t.stop()}},t,e)}))()},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},handleNodeClick:function(e){this.$emit("updateChoose",e)},getAllMedcine:function(){var e=this;return p()(u.a.mark(function t(){var a;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.h)();case 2:if(0!==(a=t.sent).code){t.next=7;break}return e.allmedcine=a.result,t.next=7,e.formatMedcine();case 7:case"end":return t.stop()}},t,e)}))()},getAllCategory:function(){var e=this;return p()(u.a.mark(function t(){var a;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.e)();case 2:0===(a=t.sent).code&&(e.allcategory=a.result,e.allcategory.forEach(function(e){e.children=[]}));case 4:case"end":return t.stop()}},t,e)}))()},formatMedcine:function(){var e=this;this.allmedcine.forEach(function(t){e.allcategory.forEach(function(e){t.categoryId==e.id&&e.children.push(t)})})},formatList:function(e,t){var a=this;this.allcategory.forEach(function(r){if(!(e&&e.length>0))return!1;e.forEach(function(e){e.id==t&&t==r.pid&&(e.children.push(r),a.formatList(e.children,r.id))})})}}},C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},["paas"===e.type||"org"===e.type?a("el-card",{staticClass:"box-card",staticStyle:{height:"100%","overflow-y":"auto"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"f4"},[e._v("药品列表")])]),e._v(" "),a("div",[a("el-input",{attrs:{size:"small",placeholder:"输入关键字进行过滤",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-tree",{ref:"tree",attrs:{data:e.list,"node-key":"id",props:e.defaultProps,"highlight-current":"","auto-expand-parent":"","filter-node-method":e.filterNode,"default-expanded-keys":[0]},on:{"node-click":e.handleNodeClick}})],1)]):e._e()],1)};C._withStripped=!0;var S={render:C,staticRenderFns:[]},N=S;var $=a("VU/8")(_,N,!1,null,null,null);$.options.__file="src/view/drug/components/DrugTree.vue";var A=$.exports,L={name:"dataManaOrg",components:{SearchInfo:k,Pagination:g.a,DrugTree:A},watch:{list:function(){this.arr=[]}},data:function(){return{arr:[],page:{pageSize:10,pageNo:1,totalCount:"",totalPage:""},oldList:[],list:[],positionKey:[{prop:"name",width:"",label:"通用名"},{prop:"typeName",width:"",label:"中/西/中成药"},{prop:"categoryName",width:"",label:"大分类"},{prop:"subcategoryName",width:"",label:"小分类"},{prop:"doseRecommendPerTime",width:"",label:"每次推荐量"},{prop:"doseRecommendPerDay",width:"",label:"每日推荐量"},{prop:"dosageFormName",width:"",label:"剂型"},{prop:"routeOfMedication",width:"",label:"给药途径"},{prop:"frequency",width:"",label:"给药频率"},{prop:"totalDose",width:"",label:"疗程总剂量"},{prop:"maxDuration",width:"",label:"最长给药持续时间"},{prop:"maxMultidaysDose",width:"",label:"最大超多日用量"},{prop:"skinTest",width:"",label:"皮试要求"}],allhospital:[],form:{standardSource:"",subcategory:""}}},created:function(){var e=this;return p()(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.getList(),t.next=3,e.getAllHospital();case 3:case"end":return t.stop()}},t,e)}))()},beforeRouteLeave:function(e,t,a){this.oldList===o()(this.list)?a():this.$confirm("当前页面未保存，是否确认离开？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a()}).catch(function(){a(!1)})},methods:{updateChoose:function(e){0===e.id?this.getList():(this.form.subcategory=e.id,this.getList(this.form))},showEdit:function(e){var t=this;return p()(u.a.mark(function a(){var r;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,GetCheckItemsDetail({liverKidneyDicId:e});case 2:0===(r=a.sent).code?(t.detail=r.result[0],t.$refs.modal.isShowModal=!0,t.$refs.modal.getCheckItemsList(),0===t.tabIndex?t.$refs.modal.getLiverList():1===t.tabIndex&&t.$refs.modal.getDneydicList()):t.$message.error(r.msg);case 4:case"end":return a.stop()}},a,t)}))()},handleDelete:function(e){var t=this;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.delete(e)}).catch(function(){})},delete:function(e){var t=this;return p()(u.a.mark(function a(){var r;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,DelateCheckLimit({liverKidneyDicId:e});case 2:0===(r=a.sent).code?(t.$message.success("删除成功!"),t.$emit("getChecklimitList")):t.$message.error(r.msg);case 4:case"end":return a.stop()}},a,t)}))()},getAllHospital:function(){var e=this;return p()(u.a.mark(function t(){var a;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.h)();case 2:0===(a=t.sent).code&&(e.allhospital=[{id:"",unitName:"全部"}].concat(s()(a.result)));case 4:case"end":return t.stop()}},t,e)}))()},handleSearch:function(){this.page={pageSize:10,pageNo:1,totalCount:"",totalPage:""},this.getList(this.form)},checkRow:function(e,t,a){var r=t.id;this.$set(this.list[a],"needAudit",e);var n=this.arr.find(function(e){return e.id===r});n?n.needAudit=Number(e):this.arr.push({id:r,needAudit:Number(e)})},handlePage:function(){this.getList(this.form)},getList:function(e){var t=this;return p()(u.a.mark(function a(){var r,i,s;return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r={pageNo:t.page.pageNo,pageSize:t.page.pageSize},i=n()(r,e),a.next=4,Object(f.i)(i);case 4:0===(s=a.sent).code?(t.list=s.result,t.page=s.page||t.page,t.list.map(function(e){return n()(e,{needAudit:Boolean(e.needAudit),skinTest:m.b.filter(function(t){return e.skinTest===t.id})[0].desp})}),t.oldList=o()(t.list)):t.$message.error(s.msg);case 6:case"end":return a.stop()}},a,t)}))()},tableRowClassName:function(e){e.row;return e.rowIndex%2==0?"row1":"row2"},tableHeaderName:function(e){e.row,e.rowIndex;return"table-header"}}},I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[a("el-form",{attrs:{inline:!0,model:e.form,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{size:"mini",placeholder:"查找药品","suffix-icon":"el-icon-search"},model:{value:e.labelName,callback:function(t){e.labelName=t},expression:"labelName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"2200%"},attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("上传")])],1)],1),e._v(" "),a("el-row",{staticStyle:{height:"100%",width:"100%"},attrs:{gutter:24}},[a("el-col",{staticStyle:{height:"100%"},attrs:{span:5}},[a("DrugTree",{ref:"drugTree",attrs:{type:"org"},on:{updateChoose:e.updateChoose}})],1),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-button",{staticStyle:{"margin-left":"2%"},attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("+添加药品")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:"",size:"small","row-class-name":e.tableRowClassName,"header-cell-class-name":e.tableHeaderName}},[e._l(e.positionKey,function(e,t){return a("el-table-column",{key:t,attrs:{prop:e.prop,label:e.label,width:e.width,align:"center"}})}),e._v(" "),a("el-table-column",{attrs:{prop:"enable",label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-edit pointer",on:{click:function(a){return e.showEdit(t.row.liverKidneyDicId)}}}),e._v(" "),a("span",{staticClass:"d-inline-block",staticStyle:{width:"8px"}}),e._v(" "),a("i",{staticClass:"el-icon-delete text-red pointer",on:{click:function(a){return e.handleDelete(t.row.liverKidneyDicId)}}})]}}])})],2),e._v(" "),a("Pagination",{staticClass:"text-center",attrs:{page:e.page},on:{handlePageChange:e.handlePage}})],1)],1)],1)};I._withStripped=!0;var T={render:I,staticRenderFns:[]},D=T;var O=a("VU/8")(L,D,!1,null,null,null);O.options.__file="src/view/drug/basic.vue";t.default=O.exports}});
//# sourceMappingURL=17.443dd839a1fddd28c383.js.map