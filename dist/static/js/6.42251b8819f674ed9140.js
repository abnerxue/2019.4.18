webpackJsonp([6],{bEcY:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("woOf"),l=t.n(a),r=t("Xxa5"),i=t.n(r),o=t("exGp"),d=t.n(o),c=t("zMP6"),s=t("cMGX"),g=t("yCvJ"),u={props:["medicinesKey"],name:"",data:function(){return{filterText:"",allcategory:[],allmedcine:[],defaultProps:{children:"children",label:"name"},list:[{id:"t01",name:"按药理作用分类",children:[]}],defaultExpand:!1,defaultExpandKey:["t01"],checkArr:[]}},created:function(){var e=this;return d()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getAllCategory();case 2:return n.next=4,e.getAllMedcine();case 4:return n.next=6,e.formatList(e.list,"t01");case 6:return n.next=8,e.setCheckedKeys();case 8:case"end":return n.stop()}},n,e)}))()},watch:{filterText:function(e){this.$refs.tree.filter(e)},medicinesKey:function(){this.setCheckedKeys(),this.toFold()}},methods:{filterNode:function(e,n){return!e||-1!==n.name.indexOf(e)},getCheckedKeys:function(){var e=this;this.checkArr=[];var n=this.$refs.tree.getCheckedKeys();n.length>0&&n.map(function(n,t){"number"==typeof n&&e.checkArr.push(n)}),this.$emit("getCheckKey",this.checkArr)},setCheckedKeys:function(){this.$refs.tree.setCheckedKeys(this.medicinesKey)},toFold:function(){for(var e in this.defaultExpand=!1,this.$refs.tree.store._getAllNodes())"t01"===this.$refs.tree.store._getAllNodes()[e].data.id?this.$refs.tree.store._getAllNodes()[e].expanded=!0:this.$refs.tree.store._getAllNodes()[e].expanded=this.defaultExpand},handleNodeClick:function(e){this.$emit("updateChoose",e)},getAllMedcine:function(){var e=this;return d()(i.a.mark(function n(){var t;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(c.h)();case 2:if(0!==(t=n.sent).code){n.next=7;break}return e.allmedcine=t.result,n.next=7,e.formatMedcine();case 7:case"end":return n.stop()}},n,e)}))()},getAllCategory:function(){var e=this;return d()(i.a.mark(function n(){var t;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(g.e)();case 2:0===(t=n.sent).code&&(e.allcategory=t.result,e.allcategory.forEach(function(e){e.id="t"+e.id,e.pid="t"+e.pid,e.children=[]}));case 4:case"end":return n.stop()}},n,e)}))()},formatMedcine:function(){var e=this;this.allmedcine.forEach(function(n){e.allcategory.forEach(function(e){"t"+n.categoryId==e.id&&(n.categoryId="t"+n.categoryId,e.children.push(n))})})},formatList:function(e,n){var t=this;this.allcategory.forEach(function(a){if(!(e&&e.length>0))return!1;e.forEach(function(e){e.id==n&&n==a.pid&&(e.children.push(a),t.formatList(e.children,a.id))})})}}},p=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("el-input",{attrs:{size:"small",placeholder:"输入关键字进行过滤",clearable:""},model:{value:e.filterText,callback:function(n){e.filterText=n},expression:"filterText"}}),e._v(" "),t("div",{staticClass:"space"}),e._v(" "),t("el-tree",{ref:"tree",staticStyle:{height:"500px","overflow-y":"auto"},attrs:{data:e.list,"node-key":"id",props:e.defaultProps,"highlight-current":"","auto-expand-parent":"","show-checkbox":"","filter-node-method":e.filterNode,"default-expanded-keys":e.defaultExpandKey},on:{"node-click":e.handleNodeClick,check:e.getCheckedKeys}})],1)};p._withStripped=!0;var b={render:p,staticRenderFns:[]},h=b;var f=t("VU/8")(u,h,!1,null,null,null);f.options.__file="src/view/drug/components/DrugTreeCheck.vue";var x=f.exports,m={name:"tagSetting",components:{Pagination:s.a,DrugTreeCheck:x},data:function(){return{labelPage:{pageSize:10,pageNo:1,totalCount:0,totalPage:0},page:{pageSize:15,pageNo:1,totalCount:"",totalPage:""},labelName:"",labelList:[],medicines:[],medicinesKey:[],medicinesMsg:"",medicinesChange:[],label:{},labelModal:{isShowLabelModal:!1,title:"",data:{id:"",name:""}},isShowMedicineModal:!1}},created:function(){this.getLabelList()},methods:{getLabelList:function(){var e=this;return d()(i.a.mark(function n(){var t,a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t={pageNo:e.labelPage.pageNo,pageSize:e.labelPage.pageSize},n.next=3,Object(c.u)(t);case 3:0===(a=n.sent).code?(e.labelList=a.result,e.labelPage=a.page||e.labelPage):e.$message.error(a.msg);case 5:case"end":return n.stop()}},n,e)}))()},getMedicineList:function(e){var n=this;return d()(i.a.mark(function t(){var a,r,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={pageNo:n.page.pageNo,pageSize:n.page.pageSize},r=l()(a,e),t.next=4,Object(c.v)(r);case 4:o=t.sent,n.medicines=[],0===o.code?o.result.length>0?(n.medicines=o.result,n.page=o.page,n.medicinesMsg="success"):(n.medicines=o.result,n.medicinesMsg=o.msg,n.page.totalCount="",n.page.totalPage=""):n.$message.error(o.msg);case 7:case"end":return t.stop()}},t,n)}))()},handleClick:function(e){this.label=e,this.page.pageNo=1,this.getMedicineList({id:this.label.id})},handlePage:function(){this.getMedicineList({id:this.label.id})},showLabelModal:function(e,n){this.labelModal.isShowLabelModal=!0,this.labelModal.title="add"===e?"添加标签":"编辑标签",this.labelModal.data=n},hideLabelModal:function(){this.labelModal.isShowLabelModal=!1},saveLabelModal:function(e){var n=this;return d()(i.a.mark(function t(){var a,l;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("add"!==e){t.next=7;break}return t.next=3,Object(c.c)({name:n.labelModal.data.name});case 3:0===(a=t.sent).code?(n.$message.success(a.msg),n.hideLabelModal(),n.getLabelList()):n.$message.error(a.msg),t.next=12;break;case 7:if("edit"!==e){t.next=12;break}return t.next=10,Object(c.F)({id:n.labelModal.data.id,name:n.labelModal.data.name});case 10:0===(l=t.sent).code?(n.$message.success(l.msg),n.hideLabelModal(),n.getLabelList()):n.$message.error(l.msg);case 12:case"end":return t.stop()}},t,n)}))()},delLabel:function(e){var n=this;return d()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.$confirm("是否删除该标签","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.l)({id:e});case 2:0===(a=t.sent).code?(n.$message.success(a.msg),n.getLabelList()):n.$message.error(a.msg);case 4:case"end":return t.stop()}},t,n)}))).catch(function(){n.$message({type:"info",message:"已取消删除"})});case 1:case"end":return t.stop()}},t,n)}))()},editMedicine:function(){var e=this;console.log("edit"),this.label.id&&(this.medicinesKey=[],this.medicines.length>0&&this.medicines.map(function(n){e.medicinesKey.push(n.medicineId)})),this.isShowMedicineModal=!0},hideMedicineModal:function(){this.isShowMedicineModal=!1},saveMedicineModal:function(){var e=this;return d()(i.a.mark(function n(){var t;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(c.G)({labelId:e.label.id,medicineId:e.medicinesChange});case 2:0===(t=n.sent).code?(e.$message.success(t.msg),e.isShowMedicineModal=!1,e.handleClick(e.label)):e.$message.error(t.msg);case 4:case"end":return n.stop()}},n,e)}))()},getCheckKey:function(e){this.medicinesChange=e}},watch:{labelName:function(){""!==this.labelName?this.getLabelList({name:this.labelName}):this.getLabelList()}}},A=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"drug-tag"},[t("el-row",{staticStyle:{height:"100%"},attrs:{gutter:20}},[t("el-col",{staticClass:"left-col",staticStyle:{height:"100%"},attrs:{span:9}},[t("div",{staticStyle:{height:"100%"}},[t("el-card",{staticClass:"box-card",staticStyle:{height:"100%","overflow-y":"auto"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"f4"},[e._v("标签管理")])]),e._v(" "),t("el-row",{staticStyle:{"border-bottom":"1px dashed #ccc",padding:"0 0 15px 15px"}},[t("el-input",{attrs:{size:"mini",placeholder:"请输入内容","suffix-icon":"el-icon-search"},model:{value:e.labelName,callback:function(n){e.labelName=n},expression:"labelName"}}),e._v(" "),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return e.showLabelModal("add",{})}}},[e._v("+新建标签")])],1),e._v(" "),e._l(e.labelList,function(n,a){return t("div",{key:a,staticClass:"label-row",on:{click:function(t){return e.handleClick(n)}}},[t("span",{staticClass:"label-name"},[e._v(e._s(n.name))]),e._v(" "),t("span",{staticClass:"label-del",on:{click:function(t){return t.stopPropagation(),e.delLabel(n.id)}}},[e._v("删 除")]),e._v(" "),t("span",{staticClass:"label-edit",on:{click:function(t){return t.stopPropagation(),e.showLabelModal("edit",n)}}},[e._v("编 辑")])])}),e._v(" "),t("Pagination",{staticClass:"text-center",attrs:{page:e.labelPage},on:{handlePageChange:e.getLabelList}})],2)],1)]),e._v(" "),t("el-col",{staticClass:"right-col",staticStyle:{height:"100%"},attrs:{span:15}},[t("el-card",{staticClass:"box-card",staticStyle:{height:"100%","overflow-y":"auto"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("el-button",{attrs:{size:"mini",type:"primary",disabled:!e.label.id},on:{click:e.editMedicine}},[e._v("编辑药品列表")])],1),e._v(" "),t("el-row",{staticClass:"title-row"},[t("span",[e._v("药品通用名")])]),e._v(" "),"success"!=e.medicinesMsg?t("el-row",{staticStyle:{"text-align":"center","padding-top":"15px","font-size":"14px"}},[e.medicinesMsg?t("span",[e._v(e._s(e.medicinesMsg))]):e._e(),e._v(" "),e.medicinesMsg?e._e():t("span",[e._v("请选择标签")])]):e._e(),e._v(" "),t("div",{staticStyle:{height:"100%"}},e._l(e.medicines,function(n,a){return t("el-row",{key:a,staticClass:"label-row"},[t("span",{staticClass:"label-name"},[e._v(e._s(n.medicineName))])])}),1),e._v(" "),t("Pagination",{staticClass:"text-center",attrs:{page:e.page},on:{handlePageChange:e.handlePage}})],1)],1)],1),e._v(" "),t("el-dialog",{staticClass:"label-modal",attrs:{title:e.labelModal.title,visible:e.labelModal.isShowLabelModal,width:"400px","before-close":e.hideLabelModal},on:{"update:visible":function(n){return e.$set(e.labelModal,"isShowLabelModal",n)}}},[t("span",[e._v("标签名称：")]),e._v(" "),t("el-input",{attrs:{size:"small",placeholder:"请输入标签名称"},model:{value:e.labelModal.data.name,callback:function(n){e.$set(e.labelModal.data,"name",n)},expression:"labelModal.data.name"}}),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:e.hideLabelModal}},[e._v("取 消")]),e._v(" "),e.labelModal.data.id?e._e():t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.saveLabelModal("add")}}},[e._v("保 存")]),e._v(" "),e.labelModal.data.id?t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.saveLabelModal("edit")}}},[e._v("保 存")]):e._e()],1)],1),e._v(" "),t("el-dialog",{staticClass:"label-modal",attrs:{title:e.label.name,visible:e.isShowMedicineModal,width:"500px",height:"100%","before-close":e.hideMedicineModal},on:{"update:visible":function(n){e.isShowMedicineModal=n}}},[t("DrugTreeCheck",{ref:"drugTree",attrs:{medicinesKey:e.medicinesKey},on:{getCheckKey:e.getCheckKey}}),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:e.hideMedicineModal}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveMedicineModal}},[e._v("保 存")])],1)],1)],1)};A._withStripped=!0;var _={render:A,staticRenderFns:[]},v=_;var C=!1;var w=t("VU/8")(m,v,!1,function(e){C||t("vgDx")},null,null);w.options.__file="src/view/drug/tag.vue";n.default=w.exports},om6U:function(e,n,t){(e.exports=t("FZ+f")(!0)).push([e.i,"\n.drug-tag {\n  height: 100%;\n}\n.drug-tag .left-col .box-card .el-input.el-input--mini.el-input--suffix {\n  width: 250px;\n}\n.drug-tag .left-col .box-card .el-button.el-button--primary.el-button--mini {\n  margin-left: 10px;\n}\n.drug-tag .left-col .box-card .el-card__body {\n  padding: 15px 0;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row {\n  border-bottom: 1px dashed #ccc;\n  padding: 10px 0;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row .label-name {\n  padding-left: 30px;\n  cursor: pointer;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row .label-edit,\n.drug-tag .left-col .box-card .el-card__body .label-row .label-del {\n  float: right;\n  cursor: pointer;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row .label-edit {\n  padding-right: 15px;\n  border-right: 1px dashed #ccc;\n  color: #409eff;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row .label-del {\n  padding-left: 15px;\n  padding-right: 30px;\n  color: #f56c6c;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row:hover {\n  background-color: #ebf5ff;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row.is-active {\n  background-color: #ebf5ff;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row.el-row {\n  font-size: 14px;\n}\n.drug-tag .right-col .box-card .el-card__header {\n  padding: 15px 20px;\n}\n.drug-tag .right-col .box-card .el-card__body {\n  padding: 15px 0;\n}\n.drug-tag .right-col .box-card .el-card__body .title-row {\n  border-bottom: 1px dashed #ccc;\n  padding: 0 0 21px 15px;\n  text-align: center;\n}\n.drug-tag .right-col .box-card .el-card__body .label-row {\n  border-bottom: 1px dashed #ccc;\n  padding: 10px 0;\n  font-size: 14px;\n}\n.drug-tag .right-col .box-card .el-card__body .label-row .label-name {\n  padding-left: 30px;\n}\n.drug-tag .label-modal .el-input.el-input--small {\n  width: 270px;\n}\n","",{version:3,sources:["C:/Users/xst/Desktop/4/frontend_v0.1/src/view/drug/C:/Users/xst/Desktop/4/frontend_v0.1/src/view/drug/tag.vue","C:/Users/xst/Desktop/4/frontend_v0.1/src/view/drug/tag.vue"],names:[],mappings:";AAmVA;EACE,aAAA;CClVD;ADiVD;EAKQ,aAAA;CCnVP;AD8UD;EAQQ,kBAAA;CCnVP;AD2UD;EAWQ,gBAAA;CCnVP;ADwUD;EAaU,+BAAA;EACA,gBAAA;CClVT;ADoUD;EAgBY,mBAAA;EACA,gBAAA;CCjVX;ADgUD;;EAqBY,aAAA;EACA,gBAAA;CCjVX;AD2TD;EAyBY,oBAAA;EACA,8BAAA;EACA,eAAA;CCjVX;ADsTD;EA8BY,mBAAA;EACA,oBAAA;EACA,eAAA;CCjVX;ADiTD;EAoCU,0BAAA;CClVT;AD8SD;EAuCU,0BAAA;CClVT;AD2SD;EA0CU,gBAAA;CClVT;ADwSD;EAkDQ,mBAAA;CCvVP;ADqSD;EAqDQ,gBAAA;CCvVP;ADkSD;EAuDU,+BAAA;EACA,uBAAA;EACA,mBAAA;CCtVT;AD6RD;EA4DU,+BAAA;EACA,gBAAA;EACA,gBAAA;CCtVT;ADwRD;EAgEY,mBAAA;CCrVX;ADqRD;EAwEM,aAAA;CC1VL",file:"tag.vue",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.drug-tag {\n  height: 100%;\n  .left-col {\n    .box-card {\n      .el-input.el-input--mini.el-input--suffix {\n        width: 250px;\n      }\n      .el-button.el-button--primary.el-button--mini {\n        margin-left: 10px;\n      }\n      .el-card__body {\n        padding: 15px 0;\n        .label-row {\n          border-bottom: 1px dashed #ccc;\n          padding: 10px 0;\n          .label-name {\n            padding-left: 30px;\n            cursor: pointer;\n          }\n          .label-edit,\n          .label-del {\n            float: right;\n            cursor: pointer;\n          }\n          .label-edit {\n            padding-right: 15px;\n            border-right: 1px dashed #ccc;\n            color: #409eff;\n          }\n          .label-del {\n            padding-left: 15px;\n            padding-right: 30px;\n            color: #f56c6c;\n          }\n        }\n        .label-row:hover {\n          background-color: rgb(235, 245, 255);\n        }\n        .label-row.is-active {\n          background-color: rgb(235, 245, 255);\n        }\n        .label-row.el-row {\n          font-size: 14px;\n        }\n      }\n    }\n  }\n  .right-col {\n    .box-card {\n      .el-card__header {\n        padding: 15px 20px;\n      }\n      .el-card__body {\n        padding: 15px 0;\n        .title-row {\n          border-bottom: 1px dashed #ccc;\n          padding: 0 0 21px 15px;\n          text-align: center;\n        }\n        .label-row {\n          border-bottom: 1px dashed #ccc;\n          padding: 10px 0;\n          font-size: 14px;\n          .label-name {\n            padding-left: 30px;\n          }\n        }\n      }\n    }\n  }\n  .label-modal {\n    .el-input.el-input--small {\n      width: 270px;\n    }\n  }\n}\n",".drug-tag {\n  height: 100%;\n}\n.drug-tag .left-col .box-card .el-input.el-input--mini.el-input--suffix {\n  width: 250px;\n}\n.drug-tag .left-col .box-card .el-button.el-button--primary.el-button--mini {\n  margin-left: 10px;\n}\n.drug-tag .left-col .box-card .el-card__body {\n  padding: 15px 0;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row {\n  border-bottom: 1px dashed #ccc;\n  padding: 10px 0;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row .label-name {\n  padding-left: 30px;\n  cursor: pointer;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row .label-edit,\n.drug-tag .left-col .box-card .el-card__body .label-row .label-del {\n  float: right;\n  cursor: pointer;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row .label-edit {\n  padding-right: 15px;\n  border-right: 1px dashed #ccc;\n  color: #409eff;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row .label-del {\n  padding-left: 15px;\n  padding-right: 30px;\n  color: #f56c6c;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row:hover {\n  background-color: #ebf5ff;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row.is-active {\n  background-color: #ebf5ff;\n}\n.drug-tag .left-col .box-card .el-card__body .label-row.el-row {\n  font-size: 14px;\n}\n.drug-tag .right-col .box-card .el-card__header {\n  padding: 15px 20px;\n}\n.drug-tag .right-col .box-card .el-card__body {\n  padding: 15px 0;\n}\n.drug-tag .right-col .box-card .el-card__body .title-row {\n  border-bottom: 1px dashed #ccc;\n  padding: 0 0 21px 15px;\n  text-align: center;\n}\n.drug-tag .right-col .box-card .el-card__body .label-row {\n  border-bottom: 1px dashed #ccc;\n  padding: 10px 0;\n  font-size: 14px;\n}\n.drug-tag .right-col .box-card .el-card__body .label-row .label-name {\n  padding-left: 30px;\n}\n.drug-tag .label-modal .el-input.el-input--small {\n  width: 270px;\n}\n"],sourceRoot:""}])},vgDx:function(e,n,t){var a=t("om6U");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);t("rjj0")("4dd19844",a,!1,{})}});
//# sourceMappingURL=6.42251b8819f674ed9140.js.map